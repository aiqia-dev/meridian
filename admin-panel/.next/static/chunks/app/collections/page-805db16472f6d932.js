(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{7128:function(e,t,n){Promise.resolve().then(n.bind(n,15128))},83774:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},99397:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},82431:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},73247:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},18930:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},55775:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a}});let s=n(47043);n(57437),n(2265);let l=s._(n(15602));function a(e,t){var n;let s={loading:e=>{let{error:t,isLoading:n,pastDelay:s}=e;return null}};"function"==typeof e&&(s.loader=e);let a={...s,...t};return(0,l.default)({...a,modules:null==(n=a.loadableGenerated)?void 0:n.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},76959:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let s=n(18993);function l(e){let{reason:t,children:n}=e;if("undefined"==typeof window)throw new s.BailoutToCSRError(t);return n}},15602:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let s=n(57437),l=n(2265),a=n(76959),c=n(70049);function i(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},r=function(e){let t={...o,...e},n=(0,l.lazy)(()=>t.loader().then(i)),r=t.loading;function d(e){let i=r?(0,s.jsx)(r,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,s.jsxs)(s.Fragment,{children:["undefined"==typeof window?(0,s.jsx)(c.PreloadCss,{moduleIds:t.modules}):null,(0,s.jsx)(n,{...e})]}):(0,s.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(n,{...e})});return(0,s.jsx)(l.Suspense,{fallback:i,children:o})}return d.displayName="LoadableComponent",d}},70049:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return a}});let s=n(57437),l=n(20544);function a(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let n=(0,l.getExpectedRequestStore)("next/dynamic css"),a=[];if(n.reactLoadableManifest&&t){let e=n.reactLoadableManifest;for(let n of t){if(!e[n])continue;let t=e[n].files.filter(e=>e.endsWith(".css"));a.push(...t)}}return 0===a.length?null:(0,s.jsx)(s.Fragment,{children:a.map(e=>(0,s.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:n.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},15128:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var s=n(57437),l=n(2265),a=n(55775),c=n.n(a),i=n(46411),o=n(79820),r=n(12381),d=n(40279),u=n(75060),m=n(93448);let x=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,s.jsx)("textarea",{className:(0,m.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...l})});x.displayName="Textarea";var h=n(15291),f=n(74291),p=n(30767),j=n(82431),y=n(99397),g=n(50091),b=n(73247),v=n(79205);let N=(0,v.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),w=(0,v.Z)("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);var k=n(18930),C=n(83774);let S=(0,v.Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),O=(0,v.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),E=(0,v.Z)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function P(e){let{content:t,className:n,iconClassName:a}=e,[c,i]=l.useState(!1);return(0,s.jsxs)("div",{className:(0,m.cn)("relative inline-flex items-center",n),children:[(0,s.jsx)("button",{type:"button",className:"p-0.5 text-muted-foreground hover:text-foreground transition-colors",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),onFocus:()=>i(!0),onBlur:()=>i(!1),"aria-label":"Help",children:(0,s.jsx)(E,{className:(0,m.cn)("w-4 h-4",a)})}),c&&(0,s.jsxs)("div",{className:"absolute z-50 bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 text-xs text-popover-foreground bg-popover border rounded-md shadow-md max-w-[280px] whitespace-normal",children:[t,(0,s.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-px border-4 border-transparent border-t-popover"})]})]})}function _(e){let{htmlFor:t,children:n,help:l,className:a}=e;return(0,s.jsxs)("div",{className:(0,m.cn)("flex items-center gap-1.5",a),children:[(0,s.jsx)("label",{htmlFor:t,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:n}),(0,s.jsx)(P,{content:l})]})}var T=n(4500);let F=c()(()=>Promise.all([n.e(226),n.e(437),n.e(687),n.e(920)]).then(n.bind(n,85920)).then(e=>e.MapDrawer),{loadableGenerated:{webpack:()=>[85920]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"w-full h-[60vh] min-h-[500px] bg-muted animate-pulse rounded-lg"})}),M=c()(()=>Promise.all([n.e(226),n.e(437),n.e(125)]).then(n.bind(n,51125)).then(e=>e.MapPointPicker),{loadableGenerated:{webpack:()=>[51125]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"w-full h-[400px] bg-muted animate-pulse rounded-lg"})});function z(){let[e,t]=(0,l.useState)([]),[n,a]=(0,l.useState)(null),[c,m]=(0,l.useState)([]),[v,E]=(0,l.useState)(""),[z,I]=(0,l.useState)(!0),[Z,L]=(0,l.useState)(!1),[D,R]=(0,l.useState)(!1),[q,B]=(0,l.useState)(""),[J,A]=(0,l.useState)(!1),[G,W]=(0,l.useState)(!1),[H,V]=(0,l.useState)(""),[U,K]=(0,l.useState)("Point"),[Y,$]=(0,l.useState)(""),[Q,X]=(0,l.useState)(""),[ee,et]=(0,l.useState)(""),[en,es]=(0,l.useState)(null),[el,ea]=(0,l.useState)(!1),[ec,ei]=(0,l.useState)(""),[eo,er]=(0,l.useState)([]),[ed,eu]=(0,l.useState)(!1),[em,ex]=(0,l.useState)(!1),[eh,ef]=(0,l.useState)(!1),[ep,ej]=(0,l.useState)(""),[ey,eg]=(0,l.useState)(""),[eb,ev]=(0,l.useState)(null),[eN,ew]=(0,l.useState)(!1),[ek,eC]=(0,l.useState)(!1),[eS,eO]=(0,l.useState)(null),[eE,eP]=(0,l.useState)(!1);(0,l.useEffect)(()=>{e_()},[]),(0,l.useEffect)(()=>{n&&eT(n)},[n]);let e_=async()=>{I(!0);try{let e=await fetch("/KEYS *");if(e.ok){let n=await e.json();if(n.ok&&n.keys){let e=await Promise.all(n.keys.map(async e=>{try{let t=await fetch("/STATS ".concat(e));if(t.ok){let n=await t.json();if(n.ok&&n.stats&&n.stats[0])return{key:e,count:n.stats[0].num_objects||0,in_memory_size:n.stats[0].in_memory_size||0}}}catch(e){}return{key:e,count:0,in_memory_size:0}}));t(e)}else t([])}}catch(e){console.error("Failed to fetch collections:",e)}finally{I(!1)}},eT=async e=>{L(!0);try{let t=await fetch("/SCAN ".concat(e," WITHFIELDS LIMIT 100"));if(t.ok){let e=await t.json();e.ok&&e.objects?m(e.objects):m([])}}catch(e){console.error("Failed to fetch objects:",e)}finally{L(!1)}},eF=async()=>{if(q.trim()){A(!0);try{(await fetch("/SET ".concat(q," __init__ POINT 0 0"))).ok&&(await fetch("/DEL ".concat(q," __init__")),await e_(),a(q),R(!1),B(""))}catch(e){console.error("Failed to create collection:",e)}finally{A(!1)}}},eM=async()=>{if(n){ex(!0);try{(await fetch("/DROP ".concat(n))).ok&&(await e_(),a(null),m([]),eu(!1))}catch(e){console.error("Failed to delete collection:",e)}finally{ex(!1)}}},ez=async()=>{if(n&&H.trim()){ea(!0),ei("");try{let e=eo.filter(e=>e.key.trim()&&e.value.trim()).map(e=>"FIELD ".concat(e.key.trim()," ").concat(e.value.trim())).join(" "),t="",s="/SET ".concat(n," ").concat(H),l=e?" ".concat(e):"";if("Point"===U){if(!Y||!Q){ei("Longitude and latitude are required for Point"),ea(!1);return}t="".concat(s).concat(l," POINT ").concat(Q," ").concat(Y)}else if("GeoJSON"===U){if(!ee.trim()){ei("GeoJSON is required"),ea(!1);return}try{JSON.parse(ee)}catch(e){ei("Invalid JSON format"),ea(!1);return}t="".concat(s).concat(l," OBJECT ").concat(ee)}else if("DrawOnMap"===U){if(!en){ei("Please draw a geometry on the map"),ea(!1);return}let e=JSON.stringify(en);t="".concat(s).concat(l," OBJECT ").concat(e)}let a=await fetch(t);if(a.ok){let e=await a.json();e.ok?(await eT(n),await e_(),W(!1),eI()):ei(e.err||"Failed to create object")}else ei("Failed to create object")}catch(e){console.error("Failed to create object:",e),ei("Failed to create object")}finally{ea(!1)}}},eI=()=>{V(""),K("Point"),$(""),X(""),et(""),es(null),ei(""),er([])},eZ=(e,t,n)=>{let s=[...eo];s[e]={key:t,value:n},er(s)},eL=e=>{er(eo.filter((t,n)=>n!==e))},eD=(0,l.useCallback)(e=>{es(e)},[]),eR=(0,l.useCallback)((e,t)=>{ej(e.toFixed(6)),eg(t.toFixed(6)),ev(null)},[]),eq=async()=>{if(n&&ep&&ey){ew(!0),ev(null);try{let e=await fetch("/INTERSECTS ".concat(n," POINT ").concat(ep," ").concat(ey));if(e.ok){let t=await e.json();t.ok&&ev({tested:!0,matches:t.objects||[]})}}catch(e){console.error("Failed to test point:",e)}finally{ew(!1)}}},eB=()=>{ej(""),eg(""),ev(null)},eJ=(e,t)=>{eO({key:e,id:t}),eC(!0)},eA=async()=>{if(eS){eP(!0);try{(await fetch("/DEL ".concat(eS.key," ").concat(eS.id))).ok&&(m(e=>e.filter(e=>e.id!==eS.id)),await e_(),eC(!1),eO(null))}catch(e){console.error("Failed to delete object:",e)}finally{eP(!1)}}},eG=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(2))," ").concat(["B","KB","MB","GB"][t])},eW=e.filter(e=>e.key.toLowerCase().includes(v.toLowerCase()));return(0,s.jsxs)(i.c,{children:[(0,s.jsxs)("div",{className:"h-full flex flex-col space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Collections"}),(0,s.jsx)(P,{content:"Collections are containers that group geospatial objects (points, lines, polygons). Each collection can contain thousands of objects that can be queried spatially."})]}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Manage your geospatial collections and objects"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(r.z,{variant:"outline",size:"sm",onClick:()=>e_(),children:[(0,s.jsx)(j.Z,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,s.jsxs)(r.z,{size:"sm",onClick:()=>R(!0),children:[(0,s.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"New Collection"]})]})]}),(0,s.jsxs)("div",{className:"flex-1 flex gap-4 min-h-0",children:[(0,s.jsxs)(o.Zb,{className:"w-80 flex-shrink-0 flex flex-col",children:[(0,s.jsxs)(o.Ol,{className:"py-3 flex-shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(g.Z,{className:"w-4 h-4"}),(0,s.jsxs)(o.ll,{className:"text-sm font-medium",children:["Collections (",e.length,")"]})]}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(b.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,s.jsx)(d.I,{placeholder:"Search collections...",className:"pl-9",value:v,onChange:e=>E(e.target.value)})]})})]}),(0,s.jsx)(o.aY,{className:"flex-1 overflow-auto p-2",children:z?(0,s.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"Loading collections..."}):0===eW.length?(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[(0,s.jsx)(g.Z,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),(0,s.jsx)("p",{children:"No collections found"}),(0,s.jsx)("p",{className:"text-xs mt-1",children:'Click "New Collection" to create one'})]}):(0,s.jsx)("div",{className:"space-y-1",children:eW.map(e=>(0,s.jsxs)("button",{onClick:()=>a(e.key),className:"w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center justify-between ".concat(n===e.key?"bg-primary text-primary-foreground":"hover:bg-accent"),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.key}),(0,s.jsxs)("div",{className:"text-xs ".concat(n===e.key?"text-primary-foreground/70":"text-muted-foreground"),children:[e.count," objects - ",eG(e.in_memory_size)]})]}),(0,s.jsx)(N,{className:"w-4 h-4"})]},e.key))})})]}),(0,s.jsxs)(o.Zb,{className:"flex-1 flex flex-col",children:[(0,s.jsx)(o.Ol,{className:"py-3 flex-shrink-0",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(o.ll,{className:"text-sm font-medium",children:n?'Objects in "'.concat(n,'"'):"Select a collection"}),n&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(r.z,{size:"sm",variant:"outline",onClick:()=>W(!0),children:[(0,s.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"Add Object"]}),(0,s.jsxs)(r.z,{size:"sm",variant:"outline",onClick:()=>{eB(),ef(!0)},children:[(0,s.jsx)(w,{className:"w-4 h-4 mr-2"}),"Test Point"]}),(0,s.jsxs)(r.z,{size:"sm",variant:"outline",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>eu(!0),children:[(0,s.jsx)(k.Z,{className:"w-4 h-4 mr-2"}),"Delete Collection"]})]})]})}),(0,s.jsx)(o.aY,{className:"flex-1 overflow-auto p-0",children:n?Z?(0,s.jsx)("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading objects..."}):0===c.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[(0,s.jsx)(C.Z,{className:"w-12 h-12 mb-3 opacity-20"}),(0,s.jsx)("p",{children:"No objects in this collection"}),(0,s.jsx)("p",{className:"text-xs mt-1",children:'Click "Add Object" to create one'})]}):(0,s.jsx)("div",{className:"divide-y",children:c.map(e=>{var t,l;return(0,s.jsx)("div",{className:"px-4 py-3 hover:bg-accent/50 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-medium text-sm truncate",children:e.id}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",(null===(t=e.object)||void 0===t?void 0:t.type)||"Unknown"]}),(null===(l=e.object)||void 0===l?void 0:l.coordinates)&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground font-mono mt-1 truncate",children:[JSON.stringify(e.object.coordinates).slice(0,50),JSON.stringify(e.object.coordinates).length>50&&"..."]}),e.fields&&e.fields.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.fields.map((e,t)=>(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-primary/10 text-primary",children:"object"==typeof e?"".concat(Object.keys(e)[0],": ").concat(Object.values(e)[0]):e},t))})]}),(0,s.jsx)(r.z,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>n&&eJ(n,e.id),children:(0,s.jsx)(k.Z,{className:"w-4 h-4"})})]})},e.id)})}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[(0,s.jsx)(C.Z,{className:"w-12 h-12 mb-3 opacity-20"}),(0,s.jsx)("p",{children:"Select a collection to view objects"})]})})]})]})]}),(0,s.jsx)(f.Vq,{open:D,onOpenChange:R,children:(0,s.jsxs)(f.cZ,{className:"w-full max-w-4xl",children:[(0,s.jsxs)(f.fK,{children:[(0,s.jsx)(f.$N,{children:"Create New Collection"}),(0,s.jsx)(f.Be,{children:"Enter a name for your new geospatial collection."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 py-4",children:[(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(_,{htmlFor:"collection-name",help:"A unique identifier for the collection. Use lowercase letters, numbers, and hyphens (e.g., 'vehicles', 'delivery-zones').",children:"Collection Name"}),(0,s.jsx)(d.I,{id:"collection-name",placeholder:"my-collection",value:q,onChange:e=>B(e.target.value),onKeyDown:e=>"Enter"===e.key&&eF()})]})}),(0,s.jsx)(T.I,{title:"CLI Example",description:"Collections are created automatically when you add the first object.",commands:[{label:"Create collection with a point:",command:"SET ".concat(q||"my-collection"," object-id POINT -23.5505 -46.6333"),description:"This creates the collection and adds a point object."},{label:"Create collection with GeoJSON:",command:"SET ".concat(q||"my-collection",' object-id OBJECT {"type":"Point","coordinates":[-46.6333,-23.5505]}'),description:"Use OBJECT for complex geometries like polygons."}]})]}),(0,s.jsxs)(f.cN,{children:[(0,s.jsx)(r.z,{variant:"outline",onClick:()=>{R(!1),B("")},children:"Cancel"}),(0,s.jsx)(r.z,{onClick:eF,disabled:!q.trim()||J,children:J?"Creating...":"Create"})]})]})}),(0,s.jsx)(f.Vq,{open:G,onOpenChange:e=>{W(e),e||eI()},children:(0,s.jsxs)(f.cZ,{className:"w-[90vw] max-w-6xl h-[85vh] flex flex-col overflow-hidden",children:[(0,s.jsxs)(f.fK,{className:"flex-shrink-0",children:[(0,s.jsx)(f.$N,{children:"Add New Object"}),(0,s.jsxs)(f.Be,{children:['Add a new geospatial object to "',n,'".']})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto py-4",children:(0,s.jsxs)("div",{className:"DrawOnMap"===U?"space-y-4":"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"DrawOnMap"===U?"":"lg:col-span-2 space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(_,{htmlFor:"object-id",help:"A unique identifier for this object within the collection. Can be any string (e.g., 'truck-123', 'warehouse-sp-01').",children:"Object ID"}),(0,s.jsx)(d.I,{id:"object-id",placeholder:"my-object-id",value:H,onChange:e=>V(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(_,{htmlFor:"object-type",help:"Choose how to define the geometry: Point for a single location, Draw on Map for polygons/lines, or GeoJSON for raw coordinate data.",children:"Type"}),(0,s.jsxs)(h.P,{id:"object-type",value:U,onChange:e=>{K(e.target.value),es(null)},children:[(0,s.jsx)("option",{value:"Point",children:"Point (Latitude/Longitude)"}),(0,s.jsx)("option",{value:"DrawOnMap",children:"Draw on Map"}),(0,s.jsx)("option",{value:"GeoJSON",children:"GeoJSON (Manual)"})]})]})]}),"Point"===U&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(_,{htmlFor:"object-lat",help:"Latitude in decimal degrees. Ranges from -90 (South Pole) to 90 (North Pole). Example: S\xe3o Paulo is -23.5505",children:"Latitude"}),(0,s.jsx)(d.I,{id:"object-lat",type:"number",step:"any",placeholder:"-23.5505",value:Q,onChange:e=>X(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(_,{htmlFor:"object-lon",help:"Longitude in decimal degrees. Ranges from -180 (West) to 180 (East). Example: S\xe3o Paulo is -46.6333",children:"Longitude"}),(0,s.jsx)(d.I,{id:"object-lon",type:"number",step:"any",placeholder:"-46.6333",value:Y,onChange:e=>$(e.target.value)})]})]}),"DrawOnMap"===U&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(_,{help:"Use the drawing tools to create a point, line, or polygon. Click on the map to add vertices. Double-click to finish. Gray objects show existing items in the collection.",children:"Draw Geometry"}),(0,s.jsx)(F,{onGeometryChange:eD,existingObjects:c}),en&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:["Geometry: ",en.type]})]}),"GeoJSON"===U&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"object-geojson",children:"GeoJSON"}),(0,s.jsx)(x,{id:"object-geojson",placeholder:'{"type": "Point", "coordinates": [-46.6333, -23.5505]}',className:"font-mono text-sm min-h-[120px]",value:ee,onChange:e=>et(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-3 pt-2 border-t",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(_,{help:"Add custom metadata fields to this object (e.g., tenant_uuid, driver_id, trip_id). Fields can be used in queries with WHERE clauses.",children:"Custom Fields (Optional)"}),(0,s.jsxs)(r.z,{type:"button",size:"sm",variant:"outline",onClick:()=>{er([...eo,{key:"",value:""}])},children:[(0,s.jsx)(y.Z,{className:"w-4 h-4 mr-1"}),"Add Field"]})]}),eo.length>0&&(0,s.jsx)("div",{className:"space-y-2",children:eo.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(d.I,{placeholder:"Field name (e.g., tenant_uuid)",value:e.key,onChange:n=>eZ(t,n.target.value,e.value),className:"flex-1"}),(0,s.jsx)(d.I,{placeholder:"Value",value:e.value,onChange:n=>eZ(t,e.key,n.target.value),className:"flex-1"}),(0,s.jsx)(r.z,{type:"button",size:"icon",variant:"ghost",onClick:()=>eL(t),className:"text-destructive hover:text-destructive",children:(0,s.jsx)(k.Z,{className:"w-4 h-4"})})]},t))}),0===eo.length&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:'No custom fields. Click "Add Field" to add metadata like tenant_uuid, driver_id, etc.'})]}),ec&&(0,s.jsx)("div",{className:"text-sm text-destructive",children:ec})]}),(0,s.jsx)("div",{className:"DrawOnMap"===U?"":"lg:col-span-1",children:(0,s.jsx)(T.I,{title:"CLI Examples",description:"Create objects via command line.",commands:"Point"===U?[{label:"Your command:",command:"SET ".concat(n||"collection"," ").concat(H||"object-id").concat(eo.filter(e=>e.key&&e.value).map(e=>" FIELD ".concat(e.key," ").concat(e.value)).join("")," POINT ").concat(Q||"-23.5505"," ").concat(Y||"-46.6333"),description:eo.length>0?"With your custom fields":"Format: SET key id POINT lat lon"},{label:"With expiration (60 seconds):",command:"SET ".concat(n||"collection"," ").concat(H||"object-id"," EX 60 POINT ").concat(Q||"-23.5505"," ").concat(Y||"-46.6333")},{label:"Query objects by field:",command:"SCAN ".concat(n||"collection"," WHERE tenant_uuid abc123"),description:"Use WHERE to filter by field values"}]:"GeoJSON"===U?[{label:"Your command:",command:"SET ".concat(n||"collection"," ").concat(H||"object-id").concat(eo.filter(e=>e.key&&e.value).map(e=>" FIELD ".concat(e.key," ").concat(e.value)).join("")," OBJECT ").concat(ee||'{"type":"Point","coordinates":[-46.6333,-23.5505]}'),description:eo.length>0?"With your custom fields":"Use OBJECT for any GeoJSON geometry."},{label:"Query objects by field:",command:"SCAN ".concat(n||"collection"," WHERE tenant_uuid abc123"),description:"Use WHERE to filter by field values"}]:[{label:"Point with fields:",command:"SET ".concat(n||"collection"," ").concat(H||"object-id"," FIELD tenant_uuid abc123 FIELD driver_id xyz POINT -23.5505 -46.6333")},{label:"Polygon with fields:",command:"SET ".concat(n||"collection"," ").concat(H||"object-id",' FIELD tenant_uuid abc123 OBJECT {"type":"Polygon","coordinates":[[[-46.7,-23.6],[-46.6,-23.6],[-46.6,-23.5],[-46.7,-23.5],[-46.7,-23.6]]]}')},{label:"Query by field:",command:"SCAN ".concat(n||"collection"," WHERE tenant_uuid abc123"),description:"Filter objects by field values"}]})})]})}),(0,s.jsxs)(f.cN,{className:"flex-shrink-0",children:[(0,s.jsx)(r.z,{variant:"outline",onClick:()=>{W(!1),eI()},children:"Cancel"}),(0,s.jsx)(r.z,{onClick:ez,disabled:!H.trim()||el,children:el?"Adding...":"Add Object"})]})]})}),(0,s.jsx)(f.Vq,{open:ed,onOpenChange:eu,children:(0,s.jsxs)(f.cZ,{className:"w-full max-w-lg",children:[(0,s.jsxs)(f.fK,{children:[(0,s.jsx)(f.$N,{children:"Delete Collection"}),(0,s.jsxs)(f.Be,{children:['Are you sure you want to delete "',n,'"? This will permanently remove all objects in this collection. This action cannot be undone.']})]}),(0,s.jsxs)(f.cN,{children:[(0,s.jsx)(r.z,{variant:"outline",onClick:()=>eu(!1),children:"Cancel"}),(0,s.jsx)(r.z,{variant:"destructive",onClick:eM,disabled:em,children:em?"Deleting...":"Delete Collection"})]})]})}),(0,s.jsx)(f.Vq,{open:eh,onOpenChange:e=>{ef(e),e||eB()},children:(0,s.jsxs)(f.cZ,{className:"w-full max-w-4xl",children:[(0,s.jsxs)(f.fK,{children:[(0,s.jsx)(f.$N,{children:"Test Point"}),(0,s.jsxs)(f.Be,{children:['Test if a point intersects with objects in "',n,'". Click on the map or enter coordinates manually.']})]}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsx)(M,{onPointSelect:eR,selectedPoint:ep&&ey?{lat:parseFloat(ep),lon:parseFloat(ey)}:null,geoObjects:c}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"test-lat",children:"Latitude"}),(0,s.jsx)(d.I,{id:"test-lat",type:"number",step:"any",placeholder:"-23.5505",value:ep,onChange:e=>{ej(e.target.value),ev(null)}})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"test-lon",children:"Longitude"}),(0,s.jsx)(d.I,{id:"test-lon",type:"number",step:"any",placeholder:"-46.6333",value:ey,onChange:e=>{eg(e.target.value),ev(null)}})]})]}),eb&&(0,s.jsxs)("div",{className:"p-4 rounded-lg border bg-muted/50",children:[(0,s.jsx)("div",{className:"flex items-center gap-2 mb-2",children:eb.matches.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S,{className:"w-5 h-5 text-green-500"}),(0,s.jsxs)("span",{className:"font-medium text-green-600",children:["Point intersects with ",eb.matches.length," object(s)"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O,{className:"w-5 h-5 text-orange-500"}),(0,s.jsx)("span",{className:"font-medium text-orange-600",children:"Point does not intersect with any objects"})]})}),eb.matches.length>0&&(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Matching objects:"}),(0,s.jsx)("div",{className:"max-h-[150px] overflow-auto space-y-1",children:eb.matches.map(e=>{var t;return(0,s.jsxs)("div",{className:"text-sm p-2 bg-background rounded border",children:[(0,s.jsx)("span",{className:"font-medium",children:e.id}),(0,s.jsxs)("span",{className:"text-muted-foreground ml-2",children:["(",(null===(t=e.object)||void 0===t?void 0:t.type)||"Unknown",")"]})]},e.id)})})]})]})]}),(0,s.jsxs)(f.cN,{children:[(0,s.jsx)(r.z,{variant:"outline",onClick:()=>{ef(!1),eB()},children:"Close"}),(0,s.jsx)(r.z,{onClick:eq,disabled:!ep||!ey||eN,children:eN?"Testing...":"Test Point"})]})]})}),(0,s.jsx)(p.aR,{open:ek,onOpenChange:e=>{eC(e),e||eO(null)},children:(0,s.jsxs)(p._T,{children:[(0,s.jsxs)(p.fY,{children:[(0,s.jsx)(p.f$,{children:"Delete Object"}),(0,s.jsxs)(p.yT,{children:['Are you sure you want to delete the object "',null==eS?void 0:eS.id,'"? This action cannot be undone.']})]}),(0,s.jsxs)(p.xo,{children:[(0,s.jsx)(p.le,{onClick:()=>{eC(!1),eO(null)},children:"Cancel"}),(0,s.jsx)(p.OL,{onClick:eA,disabled:eE,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:eE?"Deleting...":"Delete"})]})]})})]})}},30767:function(e,t,n){"use strict";n.d(t,{OL:function(){return m},_T:function(){return i},aR:function(){return c},f$:function(){return r},fY:function(){return o},le:function(){return x},xo:function(){return u},yT:function(){return d}});var s=n(57437);n(2265);var l=n(93448),a=n(12381);function c(e){let{open:t,onOpenChange:n,children:l}=e;return t?(0,s.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",onClick:()=>n(!1)}),(0,s.jsx)("div",{className:"fixed left-[50%] top-[50%] z-50 translate-x-[-50%] translate-y-[-50%]",children:l})]}):null}function i(e){let{className:t,children:n,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("w-full max-w-lg bg-card border rounded-lg shadow-lg p-6",t),...a,children:n})}function o(e){let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...n})}function r(e){let{className:t,...n}=e;return(0,s.jsx)("h2",{className:(0,l.cn)("text-lg font-semibold",t),...n})}function d(e){let{className:t,...n}=e;return(0,s.jsx)("p",{className:(0,l.cn)("text-sm text-muted-foreground",t),...n})}function u(e){let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 mt-4",t),...n})}function m(e){let{className:t,...n}=e;return(0,s.jsx)(a.z,{className:(0,l.cn)(t),...n})}function x(e){let{className:t,...n}=e;return(0,s.jsx)(a.z,{variant:"outline",className:(0,l.cn)("mt-2 sm:mt-0",t),...n})}},4500:function(e,t,n){"use strict";n.d(t,{I:function(){return u}});var s=n(57437),l=n(2265),a=n(93448),c=n(79205);let i=(0,c.Z)("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]),o=(0,c.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),r=(0,c.Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var d=n(12381);function u(e){let{title:t,description:n,commands:c,className:u}=e,[m,x]=l.useState(null),h=async(e,t)=>{try{await navigator.clipboard.writeText(e),x(t),setTimeout(()=>x(null),2e3)}catch(e){console.error("Failed to copy:",e)}};return(0,s.jsxs)("div",{className:(0,a.cn)("rounded-lg border bg-muted/30 p-4",u),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(i,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-sm font-medium",children:t||"CLI Examples"})]}),n&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:n}),(0,s.jsx)("div",{className:"space-y-3",children:c.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-1",children:[e.label&&(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:e.label}),(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("pre",{className:"bg-background border rounded-md p-3 text-xs font-mono overflow-x-auto whitespace-pre-wrap break-all",children:(0,s.jsx)("code",{children:e.command})}),(0,s.jsx)(d.z,{type:"button",variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>h(e.command,t),children:m===t?(0,s.jsx)(o,{className:"h-3.5 w-3.5 text-green-500"}):(0,s.jsx)(r,{className:"h-3.5 w-3.5"})})]}),e.description&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]},t))})]})}},74291:function(e,t,n){"use strict";n.d(t,{$N:function(){return o},Be:function(){return r},Vq:function(){return a},cN:function(){return d},cZ:function(){return c},fK:function(){return i}});var s=n(57437);n(2265);var l=n(93448);function a(e){let{open:t,onOpenChange:n,children:l}=e;return t?(0,s.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",onClick:()=>n(!1)}),(0,s.jsx)("div",{className:"fixed inset-4 z-50 flex items-center justify-center pointer-events-none",children:(0,s.jsx)("div",{className:"pointer-events-auto max-w-full max-h-full",children:l})})]}):null}function c(e){let{className:t,children:n,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("bg-card border rounded-lg shadow-lg p-6",t),...a,children:n})}function i(e){let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 mb-4",t),...n})}function o(e){let{className:t,...n}=e;return(0,s.jsx)("h2",{className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",t),...n})}function r(e){let{className:t,...n}=e;return(0,s.jsx)("p",{className:(0,l.cn)("text-sm text-muted-foreground",t),...n})}function d(e){let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex justify-end gap-2 mt-4",t),...n})}},40279:function(e,t,n){"use strict";n.d(t,{I:function(){return c}});var s=n(57437),l=n(2265),a=n(93448);let c=l.forwardRef((e,t)=>{let{className:n,type:l,...c}=e;return(0,s.jsx)("input",{type:l,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...c})});c.displayName="Input"},75060:function(e,t,n){"use strict";n.d(t,{_:function(){return c}});var s=n(57437),l=n(2265),a=n(93448);let c=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,s.jsx)("label",{ref:t,className:(0,a.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",n),...l})});c.displayName="Label"},15291:function(e,t,n){"use strict";n.d(t,{P:function(){return c}});var s=n(57437),l=n(2265),a=n(93448);let c=l.forwardRef((e,t)=>{let{className:n,children:l,...c}=e;return(0,s.jsx)("select",{className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...c,children:l})});c.displayName="Select"}},function(e){e.O(0,[891,701,508,971,117,744],function(){return e(e.s=7128)}),_N_E=e.O()}]);