(()=>{var e={};e.id=798,e.ids=[798],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3255:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c}),s(7669),s(2029),s(5866);var l=s(3191),a=s(8716),n=s(7922),i=s.n(n),o=s(5231),r={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(r[e]=()=>o[e]);s.d(t,r);let c=["",{children:["collections",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7669)),"/home/phrp/dev-aiqia/meridian/admin-panel/src/app/collections/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,2029)),"/home/phrp/dev-aiqia/meridian/admin-panel/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/home/phrp/dev-aiqia/meridian/admin-panel/src/app/collections/page.tsx"],u="/collections/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new l.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/collections/page",pathname:"/collections",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6389:(e,t,s)=>{Promise.resolve().then(s.bind(s,1725))},7636:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});let l=(0,s(2881).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},3855:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});let l=(0,s(2881).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1405:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});let l=(0,s(2881).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},8307:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});let l=(0,s(2881).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},8091:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});let l=(0,s(2881).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},3353:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let l=s(1174);s(326),s(7577);let a=l._(s(7028));function n(e,t){var s;let l={loading:e=>{let{error:t,isLoading:s,pastDelay:l}=e;return null}};"function"==typeof e&&(l.loader=e);let n={...l,...t};return(0,a.default)({...n,modules:null==(s=n.loadableGenerated)?void 0:s.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},933:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let l=s(4129);function a(e){let{reason:t,children:s}=e;throw new l.BailoutToCSRError(t)}},7028:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let l=s(326),a=s(7577),n=s(933),i=s(6618);function o(e){return{default:e&&"default"in e?e.default:e}}let r={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},c=function(e){let t={...r,...e},s=(0,a.lazy)(()=>t.loader().then(o)),c=t.loading;function d(e){let o=c?(0,l.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,r=t.ssr?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.PreloadCss,{moduleIds:t.modules}),(0,l.jsx)(s,{...e})]}):(0,l.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,l.jsx)(s,{...e})});return(0,l.jsx)(a.Suspense,{fallback:o,children:r})}return d.displayName="LoadableComponent",d}},6618:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return n}});let l=s(326),a=s(4580);function n(e){let{moduleIds:t}=e,s=(0,a.getExpectedRequestStore)("next/dynamic css"),n=[];if(s.reactLoadableManifest&&t){let e=s.reactLoadableManifest;for(let s of t){if(!e[s])continue;let t=e[s].files.filter(e=>e.endsWith(".css"));n.push(...t)}}return 0===n.length?null:(0,l.jsx)(l.Fragment,{children:n.map(e=>(0,l.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:s.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},1725:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>F});var l=s(326),a=s(7577),n=s(3353),i=s.n(n),o=s(5299),r=s(9752),c=s(1664),d=s(1190),u=s(4794),m=s(1223);let x=a.forwardRef(({className:e,...t},s)=>l.jsx("textarea",{className:(0,m.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));x.displayName="Textarea";var h=s(9280),p=s(4118),f=s(5296),j=s(1405),y=s(3855),g=s(8319),b=s(8307),v=s(2881);let N=(0,v.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),w=(0,v.Z)("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);var k=s(8091),C=s(7636);let S=(0,v.Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),O=(0,v.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),P=(0,v.Z)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function $({content:e,className:t,iconClassName:s}){let[n,i]=a.useState(!1);return(0,l.jsxs)("div",{className:(0,m.cn)("relative inline-flex items-center",t),children:[l.jsx("button",{type:"button",className:"p-0.5 text-muted-foreground hover:text-foreground transition-colors",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),onFocus:()=>i(!0),onBlur:()=>i(!1),"aria-label":"Help",children:l.jsx(P,{className:(0,m.cn)("w-4 h-4",s)})}),n&&(0,l.jsxs)("div",{className:"absolute z-50 bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 text-xs text-popover-foreground bg-popover border rounded-md shadow-md max-w-[280px] whitespace-normal",children:[e,l.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-px border-4 border-transparent border-t-popover"})]})]})}function _({htmlFor:e,children:t,help:s,className:a}){return(0,l.jsxs)("div",{className:(0,m.cn)("flex items-center gap-1.5",a),children:[l.jsx("label",{htmlFor:e,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t}),l.jsx($,{content:s})]})}var E=s(9558);let T=i()(async()=>{},{loadableGenerated:{modules:["app/collections/page.tsx -> @/components/map/map-drawer"]},ssr:!1,loading:()=>l.jsx("div",{className:"w-full h-[60vh] min-h-[500px] bg-muted animate-pulse rounded-lg"})}),M=i()(async()=>{},{loadableGenerated:{modules:["app/collections/page.tsx -> @/components/map/map-point-picker"]},ssr:!1,loading:()=>l.jsx("div",{className:"w-full h-[400px] bg-muted animate-pulse rounded-lg"})});function F(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(null),[i,m]=(0,a.useState)([]),[v,P]=(0,a.useState)(""),[F,z]=(0,a.useState)(!0),[I,Z]=(0,a.useState)(!1),[L,q]=(0,a.useState)(!1),[D,R]=(0,a.useState)(""),[A,B]=(0,a.useState)(!1),[G,J]=(0,a.useState)(!1),[W,H]=(0,a.useState)(""),[V,U]=(0,a.useState)("Point"),[K,Y]=(0,a.useState)(""),[Q,X]=(0,a.useState)(""),[ee,et]=(0,a.useState)(""),[es,el]=(0,a.useState)(null),[ea,en]=(0,a.useState)(!1),[ei,eo]=(0,a.useState)(""),[er,ec]=(0,a.useState)([]),[ed,eu]=(0,a.useState)(!1),[em,ex]=(0,a.useState)(!1),[eh,ep]=(0,a.useState)(!1),[ef,ej]=(0,a.useState)(""),[ey,eg]=(0,a.useState)(""),[eb,ev]=(0,a.useState)(null),[eN,ew]=(0,a.useState)(!1),[ek,eC]=(0,a.useState)(!1),[eS,eO]=(0,a.useState)(null),[eP,e$]=(0,a.useState)(!1),e_=async()=>{z(!0);try{let e=await fetch("/KEYS *");if(e.ok){let s=await e.json();if(s.ok&&s.keys){let e=await Promise.all(s.keys.map(async e=>{try{let t=await fetch(`/STATS ${e}`);if(t.ok){let s=await t.json();if(s.ok&&s.stats&&s.stats[0])return{key:e,count:s.stats[0].num_objects||0,in_memory_size:s.stats[0].in_memory_size||0}}}catch{}return{key:e,count:0,in_memory_size:0}}));t(e)}else t([])}}catch(e){console.error("Failed to fetch collections:",e)}finally{z(!1)}},eE=async e=>{Z(!0);try{let t=await fetch(`/SCAN ${e} WITHFIELDS LIMIT 100`);if(t.ok){let e=await t.json();e.ok&&e.objects?m(e.objects):m([])}}catch(e){console.error("Failed to fetch objects:",e)}finally{Z(!1)}},eT=async()=>{if(D.trim()){B(!0);try{(await fetch(`/SET ${D} __init__ POINT 0 0`)).ok&&(await fetch(`/DEL ${D} __init__`),await e_(),n(D),q(!1),R(""))}catch(e){console.error("Failed to create collection:",e)}finally{B(!1)}}},eM=async()=>{if(s){ex(!0);try{(await fetch(`/DROP ${s}`)).ok&&(await e_(),n(null),m([]),eu(!1))}catch(e){console.error("Failed to delete collection:",e)}finally{ex(!1)}}},eF=async()=>{if(s&&W.trim()){en(!0),eo("");try{let e=er.filter(e=>e.key.trim()&&e.value.trim()).map(e=>`FIELD ${e.key.trim()} ${e.value.trim()}`).join(" "),t="",l=`/SET ${s} ${W}`,a=e?` ${e}`:"";if("Point"===V){if(!K||!Q){eo("Longitude and latitude are required for Point"),en(!1);return}t=`${l}${a} POINT ${Q} ${K}`}else if("GeoJSON"===V){if(!ee.trim()){eo("GeoJSON is required"),en(!1);return}try{JSON.parse(ee)}catch{eo("Invalid JSON format"),en(!1);return}t=`${l}${a} OBJECT ${ee}`}else if("DrawOnMap"===V){if(!es){eo("Please draw a geometry on the map"),en(!1);return}let e=JSON.stringify(es);t=`${l}${a} OBJECT ${e}`}let n=await fetch(t);if(n.ok){let e=await n.json();e.ok?(await eE(s),await e_(),J(!1),ez()):eo(e.err||"Failed to create object")}else eo("Failed to create object")}catch(e){console.error("Failed to create object:",e),eo("Failed to create object")}finally{en(!1)}}},ez=()=>{H(""),U("Point"),Y(""),X(""),et(""),el(null),eo(""),ec([])},eI=(e,t,s)=>{let l=[...er];l[e]={key:t,value:s},ec(l)},eZ=e=>{ec(er.filter((t,s)=>s!==e))},eL=(0,a.useCallback)(e=>{el(e)},[]),eq=(0,a.useCallback)((e,t)=>{ej(e.toFixed(6)),eg(t.toFixed(6)),ev(null)},[]),eD=async()=>{if(s&&ef&&ey){ew(!0),ev(null);try{let e=await fetch(`/INTERSECTS ${s} POINT ${ef} ${ey}`);if(e.ok){let t=await e.json();t.ok&&ev({tested:!0,matches:t.objects||[]})}}catch(e){console.error("Failed to test point:",e)}finally{ew(!1)}}},eR=()=>{ej(""),eg(""),ev(null)},eA=(e,t)=>{eO({key:e,id:t}),eC(!0)},eB=async()=>{if(eS){e$(!0);try{(await fetch(`/DEL ${eS.key} ${eS.id}`)).ok&&(m(e=>e.filter(e=>e.id!==eS.id)),await e_(),eC(!1),eO(null))}catch(e){console.error("Failed to delete object:",e)}finally{e$(!1)}}},eG=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,t)).toFixed(2))} ${["B","KB","MB","GB"][t]}`},eJ=e.filter(e=>e.key.toLowerCase().includes(v.toLowerCase()));return(0,l.jsxs)(o.c,{children:[(0,l.jsxs)("div",{className:"h-full flex flex-col space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[l.jsx("h1",{className:"text-2xl font-bold",children:"Collections"}),l.jsx($,{content:"Collections are containers that group geospatial objects (points, lines, polygons). Each collection can contain thousands of objects that can be queried spatially."})]}),l.jsx("p",{className:"text-muted-foreground",children:"Manage your geospatial collections and objects"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>e_(),children:[l.jsx(j.Z,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,l.jsxs)(c.z,{size:"sm",onClick:()=>q(!0),children:[l.jsx(y.Z,{className:"w-4 h-4 mr-2"}),"New Collection"]})]})]}),(0,l.jsxs)("div",{className:"flex-1 flex gap-4 min-h-0",children:[(0,l.jsxs)(r.Zb,{className:"w-80 flex-shrink-0 flex flex-col",children:[(0,l.jsxs)(r.Ol,{className:"py-3 flex-shrink-0",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[l.jsx(g.Z,{className:"w-4 h-4"}),(0,l.jsxs)(r.ll,{className:"text-sm font-medium",children:["Collections (",e.length,")"]})]}),l.jsx("div",{className:"mt-2",children:(0,l.jsxs)("div",{className:"relative",children:[l.jsx(b.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),l.jsx(d.I,{placeholder:"Search collections...",className:"pl-9",value:v,onChange:e=>P(e.target.value)})]})})]}),l.jsx(r.aY,{className:"flex-1 overflow-auto p-2",children:F?l.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"Loading collections..."}):0===eJ.length?(0,l.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[l.jsx(g.Z,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),l.jsx("p",{children:"No collections found"}),l.jsx("p",{className:"text-xs mt-1",children:'Click "New Collection" to create one'})]}):l.jsx("div",{className:"space-y-1",children:eJ.map(e=>(0,l.jsxs)("button",{onClick:()=>n(e.key),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center justify-between ${s===e.key?"bg-primary text-primary-foreground":"hover:bg-accent"}`,children:[(0,l.jsxs)("div",{children:[l.jsx("div",{className:"font-medium",children:e.key}),(0,l.jsxs)("div",{className:`text-xs ${s===e.key?"text-primary-foreground/70":"text-muted-foreground"}`,children:[e.count," objects - ",eG(e.in_memory_size)]})]}),l.jsx(N,{className:"w-4 h-4"})]},e.key))})})]}),(0,l.jsxs)(r.Zb,{className:"flex-1 flex flex-col",children:[l.jsx(r.Ol,{className:"py-3 flex-shrink-0",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[l.jsx(r.ll,{className:"text-sm font-medium",children:s?`Objects in "${s}"`:"Select a collection"}),s&&(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>J(!0),children:[l.jsx(y.Z,{className:"w-4 h-4 mr-2"}),"Add Object"]}),(0,l.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>{eR(),ep(!0)},children:[l.jsx(w,{className:"w-4 h-4 mr-2"}),"Test Point"]}),(0,l.jsxs)(c.z,{size:"sm",variant:"outline",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>eu(!0),children:[l.jsx(k.Z,{className:"w-4 h-4 mr-2"}),"Delete Collection"]})]})]})}),l.jsx(r.aY,{className:"flex-1 overflow-auto p-0",children:s?I?l.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading objects..."}):0===i.length?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[l.jsx(C.Z,{className:"w-12 h-12 mb-3 opacity-20"}),l.jsx("p",{children:"No objects in this collection"}),l.jsx("p",{className:"text-xs mt-1",children:'Click "Add Object" to create one'})]}):l.jsx("div",{className:"divide-y",children:i.map(e=>l.jsx("div",{className:"px-4 py-3 hover:bg-accent/50 transition-colors",children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"font-medium text-sm truncate",children:e.id}),(0,l.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",e.object?.type||"Unknown"]}),e.object?.coordinates&&(0,l.jsxs)("div",{className:"text-xs text-muted-foreground font-mono mt-1 truncate",children:[JSON.stringify(e.object.coordinates).slice(0,50),JSON.stringify(e.object.coordinates).length>50&&"..."]}),e.fields&&e.fields.length>0&&l.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:e.fields.map((e,t)=>l.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-primary/10 text-primary",children:"object"==typeof e?`${Object.keys(e)[0]}: ${Object.values(e)[0]}`:e},t))})]}),l.jsx(c.z,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>s&&eA(s,e.id),children:l.jsx(k.Z,{className:"w-4 h-4"})})]})},e.id))}):(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[l.jsx(C.Z,{className:"w-12 h-12 mb-3 opacity-20"}),l.jsx("p",{children:"Select a collection to view objects"})]})})]})]})]}),l.jsx(p.Vq,{open:L,onOpenChange:q,children:(0,l.jsxs)(p.cZ,{className:"w-full max-w-4xl",children:[(0,l.jsxs)(p.fK,{children:[l.jsx(p.$N,{children:"Create New Collection"}),l.jsx(p.Be,{children:"Enter a name for your new geospatial collection."})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 py-4",children:[l.jsx("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(_,{htmlFor:"collection-name",help:"A unique identifier for the collection. Use lowercase letters, numbers, and hyphens (e.g., 'vehicles', 'delivery-zones').",children:"Collection Name"}),l.jsx(d.I,{id:"collection-name",placeholder:"my-collection",value:D,onChange:e=>R(e.target.value),onKeyDown:e=>"Enter"===e.key&&eT()})]})}),l.jsx(E.I,{title:"CLI Example",description:"Collections are created automatically when you add the first object.",commands:[{label:"Create collection with a point:",command:`SET ${D||"my-collection"} object-id POINT -23.5505 -46.6333`,description:"This creates the collection and adds a point object."},{label:"Create collection with GeoJSON:",command:`SET ${D||"my-collection"} object-id OBJECT {"type":"Point","coordinates":[-46.6333,-23.5505]}`,description:"Use OBJECT for complex geometries like polygons."}]})]}),(0,l.jsxs)(p.cN,{children:[l.jsx(c.z,{variant:"outline",onClick:()=>{q(!1),R("")},children:"Cancel"}),l.jsx(c.z,{onClick:eT,disabled:!D.trim()||A,children:A?"Creating...":"Create"})]})]})}),l.jsx(p.Vq,{open:G,onOpenChange:e=>{J(e),e||ez()},children:(0,l.jsxs)(p.cZ,{className:"w-[90vw] max-w-6xl h-[85vh] flex flex-col overflow-hidden",children:[(0,l.jsxs)(p.fK,{className:"flex-shrink-0",children:[l.jsx(p.$N,{children:"Add New Object"}),(0,l.jsxs)(p.Be,{children:['Add a new geospatial object to "',s,'".']})]}),l.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:(0,l.jsxs)("div",{className:"DrawOnMap"===V?"space-y-4":"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"DrawOnMap"===V?"":"lg:col-span-2 space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(_,{htmlFor:"object-id",help:"A unique identifier for this object within the collection. Can be any string (e.g., 'truck-123', 'warehouse-sp-01').",children:"Object ID"}),l.jsx(d.I,{id:"object-id",placeholder:"my-object-id",value:W,onChange:e=>H(e.target.value)})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(_,{htmlFor:"object-type",help:"Choose how to define the geometry: Point for a single location, Draw on Map for polygons/lines, or GeoJSON for raw coordinate data.",children:"Type"}),(0,l.jsxs)(h.P,{id:"object-type",value:V,onChange:e=>{U(e.target.value),el(null)},children:[l.jsx("option",{value:"Point",children:"Point (Latitude/Longitude)"}),l.jsx("option",{value:"DrawOnMap",children:"Draw on Map"}),l.jsx("option",{value:"GeoJSON",children:"GeoJSON (Manual)"})]})]})]}),"Point"===V&&(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(_,{htmlFor:"object-lat",help:"Latitude in decimal degrees. Ranges from -90 (South Pole) to 90 (North Pole). Example: S\xe3o Paulo is -23.5505",children:"Latitude"}),l.jsx(d.I,{id:"object-lat",type:"number",step:"any",placeholder:"-23.5505",value:Q,onChange:e=>X(e.target.value)})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(_,{htmlFor:"object-lon",help:"Longitude in decimal degrees. Ranges from -180 (West) to 180 (East). Example: S\xe3o Paulo is -46.6333",children:"Longitude"}),l.jsx(d.I,{id:"object-lon",type:"number",step:"any",placeholder:"-46.6333",value:K,onChange:e=>Y(e.target.value)})]})]}),"DrawOnMap"===V&&(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(_,{help:"Use the drawing tools to create a point, line, or polygon. Click on the map to add vertices. Double-click to finish. Gray objects show existing items in the collection.",children:"Draw Geometry"}),l.jsx(T,{onGeometryChange:eL,existingObjects:i}),es&&(0,l.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:["Geometry: ",es.type]})]}),"GeoJSON"===V&&(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(u._,{htmlFor:"object-geojson",children:"GeoJSON"}),l.jsx(x,{id:"object-geojson",placeholder:'{"type": "Point", "coordinates": [-46.6333, -23.5505]}',className:"font-mono text-sm min-h-[120px]",value:ee,onChange:e=>et(e.target.value)})]}),(0,l.jsxs)("div",{className:"space-y-3 pt-2 border-t",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[l.jsx(_,{help:"Add custom metadata fields to this object (e.g., tenant_uuid, driver_id, trip_id). Fields can be used in queries with WHERE clauses.",children:"Custom Fields (Optional)"}),(0,l.jsxs)(c.z,{type:"button",size:"sm",variant:"outline",onClick:()=>{ec([...er,{key:"",value:""}])},children:[l.jsx(y.Z,{className:"w-4 h-4 mr-1"}),"Add Field"]})]}),er.length>0&&l.jsx("div",{className:"space-y-2",children:er.map((e,t)=>(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[l.jsx(d.I,{placeholder:"Field name (e.g., tenant_uuid)",value:e.key,onChange:s=>eI(t,s.target.value,e.value),className:"flex-1"}),l.jsx(d.I,{placeholder:"Value",value:e.value,onChange:s=>eI(t,e.key,s.target.value),className:"flex-1"}),l.jsx(c.z,{type:"button",size:"icon",variant:"ghost",onClick:()=>eZ(t),className:"text-destructive hover:text-destructive",children:l.jsx(k.Z,{className:"w-4 h-4"})})]},t))}),0===er.length&&l.jsx("p",{className:"text-xs text-muted-foreground",children:'No custom fields. Click "Add Field" to add metadata like tenant_uuid, driver_id, etc.'})]}),ei&&l.jsx("div",{className:"text-sm text-destructive",children:ei})]}),l.jsx("div",{className:"DrawOnMap"===V?"":"lg:col-span-1",children:l.jsx(E.I,{title:"CLI Examples",description:"Create objects via command line.",commands:"Point"===V?[{label:"Your command:",command:`SET ${s||"collection"} ${W||"object-id"}${er.filter(e=>e.key&&e.value).map(e=>` FIELD ${e.key} ${e.value}`).join("")} POINT ${Q||"-23.5505"} ${K||"-46.6333"}`,description:er.length>0?"With your custom fields":"Format: SET key id POINT lat lon"},{label:"With expiration (60 seconds):",command:`SET ${s||"collection"} ${W||"object-id"} EX 60 POINT ${Q||"-23.5505"} ${K||"-46.6333"}`},{label:"Query objects by field:",command:`SCAN ${s||"collection"} WHERE tenant_uuid abc123`,description:"Use WHERE to filter by field values"}]:"GeoJSON"===V?[{label:"Your command:",command:`SET ${s||"collection"} ${W||"object-id"}${er.filter(e=>e.key&&e.value).map(e=>` FIELD ${e.key} ${e.value}`).join("")} OBJECT ${ee||'{"type":"Point","coordinates":[-46.6333,-23.5505]}'}`,description:er.length>0?"With your custom fields":"Use OBJECT for any GeoJSON geometry."},{label:"Query objects by field:",command:`SCAN ${s||"collection"} WHERE tenant_uuid abc123`,description:"Use WHERE to filter by field values"}]:[{label:"Point with fields:",command:`SET ${s||"collection"} ${W||"object-id"} FIELD tenant_uuid abc123 FIELD driver_id xyz POINT -23.5505 -46.6333`},{label:"Polygon with fields:",command:`SET ${s||"collection"} ${W||"object-id"} FIELD tenant_uuid abc123 OBJECT {"type":"Polygon","coordinates":[[[-46.7,-23.6],[-46.6,-23.6],[-46.6,-23.5],[-46.7,-23.5],[-46.7,-23.6]]]}`},{label:"Query by field:",command:`SCAN ${s||"collection"} WHERE tenant_uuid abc123`,description:"Filter objects by field values"}]})})]})}),(0,l.jsxs)(p.cN,{className:"flex-shrink-0",children:[l.jsx(c.z,{variant:"outline",onClick:()=>{J(!1),ez()},children:"Cancel"}),l.jsx(c.z,{onClick:eF,disabled:!W.trim()||ea,children:ea?"Adding...":"Add Object"})]})]})}),l.jsx(p.Vq,{open:ed,onOpenChange:eu,children:(0,l.jsxs)(p.cZ,{className:"w-full max-w-lg",children:[(0,l.jsxs)(p.fK,{children:[l.jsx(p.$N,{children:"Delete Collection"}),(0,l.jsxs)(p.Be,{children:['Are you sure you want to delete "',s,'"? This will permanently remove all objects in this collection. This action cannot be undone.']})]}),(0,l.jsxs)(p.cN,{children:[l.jsx(c.z,{variant:"outline",onClick:()=>eu(!1),children:"Cancel"}),l.jsx(c.z,{variant:"destructive",onClick:eM,disabled:em,children:em?"Deleting...":"Delete Collection"})]})]})}),l.jsx(p.Vq,{open:eh,onOpenChange:e=>{ep(e),e||eR()},children:(0,l.jsxs)(p.cZ,{className:"w-full max-w-4xl",children:[(0,l.jsxs)(p.fK,{children:[l.jsx(p.$N,{children:"Test Point"}),(0,l.jsxs)(p.Be,{children:['Test if a point intersects with objects in "',s,'". Click on the map or enter coordinates manually.']})]}),(0,l.jsxs)("div",{className:"space-y-4 py-4",children:[l.jsx(M,{onPointSelect:eq,selectedPoint:ef&&ey?{lat:parseFloat(ef),lon:parseFloat(ey)}:null,geoObjects:i}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(u._,{htmlFor:"test-lat",children:"Latitude"}),l.jsx(d.I,{id:"test-lat",type:"number",step:"any",placeholder:"-23.5505",value:ef,onChange:e=>{ej(e.target.value),ev(null)}})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(u._,{htmlFor:"test-lon",children:"Longitude"}),l.jsx(d.I,{id:"test-lon",type:"number",step:"any",placeholder:"-46.6333",value:ey,onChange:e=>{eg(e.target.value),ev(null)}})]})]}),eb&&(0,l.jsxs)("div",{className:"p-4 rounded-lg border bg-muted/50",children:[l.jsx("div",{className:"flex items-center gap-2 mb-2",children:eb.matches.length>0?(0,l.jsxs)(l.Fragment,{children:[l.jsx(S,{className:"w-5 h-5 text-green-500"}),(0,l.jsxs)("span",{className:"font-medium text-green-600",children:["Point intersects with ",eb.matches.length," object(s)"]})]}):(0,l.jsxs)(l.Fragment,{children:[l.jsx(O,{className:"w-5 h-5 text-orange-500"}),l.jsx("span",{className:"font-medium text-orange-600",children:"Point does not intersect with any objects"})]})}),eb.matches.length>0&&(0,l.jsxs)("div",{className:"mt-3 space-y-2",children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Matching objects:"}),l.jsx("div",{className:"max-h-[150px] overflow-auto space-y-1",children:eb.matches.map(e=>(0,l.jsxs)("div",{className:"text-sm p-2 bg-background rounded border",children:[l.jsx("span",{className:"font-medium",children:e.id}),(0,l.jsxs)("span",{className:"text-muted-foreground ml-2",children:["(",e.object?.type||"Unknown",")"]})]},e.id))})]})]})]}),(0,l.jsxs)(p.cN,{children:[l.jsx(c.z,{variant:"outline",onClick:()=>{ep(!1),eR()},children:"Close"}),l.jsx(c.z,{onClick:eD,disabled:!ef||!ey||eN,children:eN?"Testing...":"Test Point"})]})]})}),l.jsx(f.aR,{open:ek,onOpenChange:e=>{eC(e),e||eO(null)},children:(0,l.jsxs)(f._T,{children:[(0,l.jsxs)(f.fY,{children:[l.jsx(f.f$,{children:"Delete Object"}),(0,l.jsxs)(f.yT,{children:['Are you sure you want to delete the object "',eS?.id,'"? This action cannot be undone.']})]}),(0,l.jsxs)(f.xo,{children:[l.jsx(f.le,{onClick:()=>{eC(!1),eO(null)},children:"Cancel"}),l.jsx(f.OL,{onClick:eB,disabled:eP,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:eP?"Deleting...":"Delete"})]})]})})]})}},5296:(e,t,s)=>{"use strict";s.d(t,{OL:()=>m,_T:()=>o,aR:()=>i,f$:()=>c,fY:()=>r,le:()=>x,xo:()=>u,yT:()=>d});var l=s(326);s(7577);var a=s(1223),n=s(1664);function i({open:e,onOpenChange:t,children:s}){return e?(0,l.jsxs)("div",{className:"fixed inset-0 z-50",children:[l.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",onClick:()=>t(!1)}),l.jsx("div",{className:"fixed left-[50%] top-[50%] z-50 translate-x-[-50%] translate-y-[-50%]",children:s})]}):null}function o({className:e,children:t,...s}){return l.jsx("div",{className:(0,a.cn)("w-full max-w-lg bg-card border rounded-lg shadow-lg p-6",e),...s,children:t})}function r({className:e,...t}){return l.jsx("div",{className:(0,a.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t})}function c({className:e,...t}){return l.jsx("h2",{className:(0,a.cn)("text-lg font-semibold",e),...t})}function d({className:e,...t}){return l.jsx("p",{className:(0,a.cn)("text-sm text-muted-foreground",e),...t})}function u({className:e,...t}){return l.jsx("div",{className:(0,a.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 mt-4",e),...t})}function m({className:e,...t}){return l.jsx(n.z,{className:(0,a.cn)(e),...t})}function x({className:e,...t}){return l.jsx(n.z,{variant:"outline",className:(0,a.cn)("mt-2 sm:mt-0",e),...t})}},9558:(e,t,s)=>{"use strict";s.d(t,{I:()=>u});var l=s(326),a=s(7577),n=s(1223),i=s(2881);let o=(0,i.Z)("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]),r=(0,i.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),c=(0,i.Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var d=s(1664);function u({title:e,description:t,commands:s,className:i}){let[u,m]=a.useState(null),x=async(e,t)=>{try{await navigator.clipboard.writeText(e),m(t),setTimeout(()=>m(null),2e3)}catch(e){console.error("Failed to copy:",e)}};return(0,l.jsxs)("div",{className:(0,n.cn)("rounded-lg border bg-muted/30 p-4",i),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(o,{className:"w-4 h-4 text-muted-foreground"}),l.jsx("h3",{className:"text-sm font-medium",children:e||"CLI Examples"})]}),t&&l.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:t}),l.jsx("div",{className:"space-y-3",children:s.map((e,t)=>(0,l.jsxs)("div",{className:"space-y-1",children:[e.label&&l.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:e.label}),(0,l.jsxs)("div",{className:"relative group",children:[l.jsx("pre",{className:"bg-background border rounded-md p-3 text-xs font-mono overflow-x-auto whitespace-pre-wrap break-all",children:l.jsx("code",{children:e.command})}),l.jsx(d.z,{type:"button",variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>x(e.command,t),children:u===t?l.jsx(r,{className:"h-3.5 w-3.5 text-green-500"}):l.jsx(c,{className:"h-3.5 w-3.5"})})]}),e.description&&l.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]},t))})]})}},4118:(e,t,s)=>{"use strict";s.d(t,{$N:()=>r,Be:()=>c,Vq:()=>n,cN:()=>d,cZ:()=>i,fK:()=>o});var l=s(326);s(7577);var a=s(1223);function n({open:e,onOpenChange:t,children:s}){return e?(0,l.jsxs)("div",{className:"fixed inset-0 z-50",children:[l.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",onClick:()=>t(!1)}),l.jsx("div",{className:"fixed inset-4 z-50 flex items-center justify-center pointer-events-none",children:l.jsx("div",{className:"pointer-events-auto max-w-full max-h-full",children:s})})]}):null}function i({className:e,children:t,...s}){return l.jsx("div",{className:(0,a.cn)("bg-card border rounded-lg shadow-lg p-6",e),...s,children:t})}function o({className:e,...t}){return l.jsx("div",{className:(0,a.cn)("flex flex-col space-y-1.5 mb-4",e),...t})}function r({className:e,...t}){return l.jsx("h2",{className:(0,a.cn)("text-lg font-semibold leading-none tracking-tight",e),...t})}function c({className:e,...t}){return l.jsx("p",{className:(0,a.cn)("text-sm text-muted-foreground",e),...t})}function d({className:e,...t}){return l.jsx("div",{className:(0,a.cn)("flex justify-end gap-2 mt-4",e),...t})}},1190:(e,t,s)=>{"use strict";s.d(t,{I:()=>i});var l=s(326),a=s(7577),n=s(1223);let i=a.forwardRef(({className:e,type:t,...s},a)=>l.jsx("input",{type:t,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));i.displayName="Input"},4794:(e,t,s)=>{"use strict";s.d(t,{_:()=>i});var l=s(326),a=s(7577),n=s(1223);let i=a.forwardRef(({className:e,...t},s)=>l.jsx("label",{ref:s,className:(0,n.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...t}));i.displayName="Label"},9280:(e,t,s)=>{"use strict";s.d(t,{P:()=>i});var l=s(326),a=s(7577),n=s(1223);let i=a.forwardRef(({className:e,children:t,...s},a)=>l.jsx("select",{className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s,children:t}));i.displayName="Select"},7669:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});let l=(0,s(8570).createProxy)(String.raw`/home/phrp/dev-aiqia/meridian/admin-panel/src/app/collections/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),l=t.X(0,[975,629,691,864],()=>s(3255));module.exports=l})();