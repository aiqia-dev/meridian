(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{54806:function(e,t,s){Promise.resolve().then(s.bind(s,81523))},81523:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return k}});var i=s(57437),l=s(2265),a=s(46411),o=s(79820),n=s(93448);function r(e){let{title:t,value:s,description:l,icon:a,trend:r,className:c}=e;return(0,i.jsxs)(o.Zb,{className:c,children:[(0,i.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,i.jsx)(o.ll,{className:"text-sm font-medium text-muted-foreground",children:t}),(0,i.jsx)(a,{className:"h-4 w-4 text-muted-foreground"})]}),(0,i.jsxs)(o.aY,{children:[(0,i.jsx)("div",{className:"text-2xl font-bold",children:s}),l&&(0,i.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:l}),r&&(0,i.jsxs)("p",{className:(0,n.cn)("text-xs mt-1",r.isPositive?"text-green-500":"text-red-500"),children:[r.isPositive?"+":"-",Math.abs(r.value),"% from last hour"]})]})]})}var c=s(47625),d=s(58336),u=s(56940),x=s(97059),m=s(62994),v=s(8147),h=s(54061);function p(e){let{title:t,data:s,color:l="hsl(var(--primary))",unit:a=""}=e;return(0,i.jsxs)(o.Zb,{children:[(0,i.jsx)(o.Ol,{children:(0,i.jsx)(o.ll,{className:"text-sm font-medium",children:t})}),(0,i.jsx)(o.aY,{children:(0,i.jsx)("div",{className:"h-[200px]",children:(0,i.jsx)(c.h,{width:"100%",height:"100%",children:(0,i.jsxs)(d.w,{data:s,children:[(0,i.jsx)(u.q,{strokeDasharray:"3 3",className:"stroke-muted",vertical:!1}),(0,i.jsx)(x.K,{dataKey:"time",tick:{fontSize:12},tickLine:!1,axisLine:!1,className:"text-muted-foreground"}),(0,i.jsx)(m.B,{tick:{fontSize:12},tickLine:!1,axisLine:!1,className:"text-muted-foreground",tickFormatter:e=>"".concat(e).concat(a)}),(0,i.jsx)(v.u,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"var(--radius)"},labelStyle:{color:"hsl(var(--foreground))"},itemStyle:{color:"hsl(var(--foreground))"}}),(0,i.jsx)(h.x,{type:"monotone",dataKey:"value",stroke:l,strokeWidth:2,dot:!1})]})})})})]})}var j=s(28124),f=s(83774),g=s(84428),_=s(9217),y=s(50091),N=s(13420),b=s(91723);function k(){var e,t,s,o,n,c,d,u,x,m,v;let[h,k]=(0,l.useState)(null),[z,S]=(0,l.useState)([]),[M,w]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/SERVER");if(e.ok){let t=await e.json();if(t.ok&&t.stats){k(t.stats);let e=new Date,s="".concat(e.getHours(),":").concat(e.getMinutes().toString().padStart(2,"0"));S(e=>[...e,{time:s,value:t.stats.heap_size/1048576}].slice(-20))}}}catch(e){console.error("Failed to fetch stats:",e)}finally{w(!1)}};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[]);let Z=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(2))," ").concat(["B","KB","MB","GB"][t])};return M?(0,i.jsx)(a.c,{children:(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,i.jsx)("div",{className:"animate-pulse text-muted-foreground",children:"Loading metrics..."})})}):(0,i.jsx)(a.c,{children:(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"Dashboard"}),(0,i.jsxs)("p",{className:"text-muted-foreground",children:["Real-time server metrics and statistics",(null==h?void 0:h.version)&&(0,i.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-primary/10 rounded text-xs",children:["v",h.version]})]})]}),(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[(0,i.jsx)(r,{title:"Collections",value:null!==(e=null==h?void 0:h.num_collections)&&void 0!==e?e:0,description:"Total geospatial collections",icon:j.Z}),(0,i.jsx)(r,{title:"Objects",value:null!==(t=null==h?void 0:h.num_objects)&&void 0!==t?t:0,description:"Total stored objects",icon:f.Z}),(0,i.jsx)(r,{title:"Memory Usage",value:Z(null!==(s=null==h?void 0:h.heap_size)&&void 0!==s?s:0),description:"Current heap size",icon:g.Z}),(0,i.jsx)(r,{title:"Memory Available",value:Z((null==h?void 0:h.max_heap_size)&&h.max_heap_size>0?Math.max(0,h.max_heap_size-(null!==(o=null==h?void 0:h.heap_size)&&void 0!==o?o:0)):null!==(n=null==h?void 0:h.heap_released)&&void 0!==n?n:0),description:(null==h?void 0:h.max_heap_size)&&h.max_heap_size>0?"of ".concat(Z(h.max_heap_size)," limit"):"Released to OS",icon:_.Z}),(0,i.jsx)(r,{title:"Points",value:null!==(c=null==h?void 0:h.num_points)&&void 0!==c?c:0,description:"Total geospatial points",icon:y.Z})]}),(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,i.jsx)(p,{title:"Memory Usage (MB)",data:z,color:"hsl(var(--primary))",unit:"MB"}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(r,{title:"AOF Size",value:Z(null!==(d=null==h?void 0:h.aof_size)&&void 0!==d?d:0),description:"Append-only file size",icon:y.Z}),(0,i.jsx)(r,{title:"In-Memory Size",value:Z(null!==(u=null==h?void 0:h.in_memory_size)&&void 0!==u?u:0),description:"Total in-memory data",icon:g.Z})]})]}),(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,i.jsx)(r,{title:"Hooks",value:null!==(x=null==h?void 0:h.num_hooks)&&void 0!==x?x:0,description:"Active webhooks/geofences",icon:N.Z}),(0,i.jsx)(r,{title:"Strings",value:null!==(m=null==h?void 0:h.num_strings)&&void 0!==m?m:0,description:"Stored string values",icon:y.Z}),(0,i.jsx)(r,{title:"CPUs",value:null!==(v=null==h?void 0:h.cpus)&&void 0!==v?v:0,description:"Available CPU cores",icon:b.Z})]})]})})}}},function(e){e.O(0,[891,701,155,508,971,117,744],function(){return e(e.s=54806)}),_N_E=e.O()}]);