"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[125],{51125:function(e,t,n){n.r(t),n.d(t,{MapPointPicker:function(){return b}});var r=n(57437),s=n(2265),l=n(39499),i=n(95931),o=n(96480),c=n(68906),a=n(9043),d=n(89202),f=n(69984),u=n(30194),w=n(21595),m=n(8367),Z=n(70713),h=n(12646),x=n(78826),g=n(42086),p=n(47545);function b(e){let{onPointSelect:t,selectedPoint:n,geoObjects:b=[]}=e,j=(0,s.useRef)(null),[v,y]=(0,s.useState)(null),[k]=(0,s.useState)(()=>new a.Z),[N]=(0,s.useState)(()=>new a.Z);return(0,s.useEffect)(()=>{if(!j.current)return;let e=new c.Z({source:N,style:new u.ZP({fill:new w.Z({color:"rgba(59, 130, 246, 0.3)"}),stroke:new m.Z({color:"#3b82f6",width:2}),image:new Z.Z({radius:6,fill:new w.Z({color:"#3b82f6"}),stroke:new m.Z({color:"#ffffff",width:2})})})}),n=new c.Z({source:k,style:new u.ZP({image:new Z.Z({radius:10,fill:new w.Z({color:"#ef4444"}),stroke:new m.Z({color:"#ffffff",width:3})})})}),r=new l.Z({target:j.current,layers:[new o.Z({source:new d.Z}),e,n],view:new i.ZP({center:(0,f.mi)([-46.6333,-23.5505]),zoom:4})});return r.on("click",e=>{let[n,r]=(0,f.bU)(e.coordinate);t(r,n)}),y(r),()=>{r.setTarget(void 0)}},[t,k,N]),(0,s.useEffect)(()=>{if(N.clear(),b.forEach(e=>{let t;if(!e.object)return;let n=e.object.coordinates;if("Point"===e.object.type&&Array.isArray(n)&&2===n.length?t=new x.Z((0,f.mi)(n)):"LineString"===e.object.type?t=new g.Z(n.map(e=>(0,f.mi)(e))):"Polygon"===e.object.type&&(t=new p.ZP([n[0].map(e=>(0,f.mi)(e))])),t){let n=new h.Z({geometry:t,id:e.id});n.set("id",e.id),N.addFeature(n)}}),b.length>0&&v&&!n){let e=N.getExtent();e[0]!==1/0&&v.getView().fit(e,{padding:[50,50,50,50],maxZoom:15})}},[b,N,v,n]),(0,s.useEffect)(()=>{if(k.clear(),n){let e=new h.Z({geometry:new x.Z((0,f.mi)([n.lon,n.lat]))});k.addFeature(e)}},[n,k]),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{ref:j,className:"w-full h-[400px] rounded-lg overflow-hidden border cursor-crosshair"}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,r.jsx)("span",{children:"Collection objects"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,r.jsx)("span",{children:"Test point"})]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Click on the map to select a test point"})]})}n(86037)}}]);