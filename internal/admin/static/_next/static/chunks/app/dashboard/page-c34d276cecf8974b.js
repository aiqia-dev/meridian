(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{54806:function(e,t,s){Promise.resolve().then(s.bind(s,81523))},81523:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return S}});var l=s(57437),i=s(2265),o=s(17054),a=s(79820),n=s(93448);function r(e){let{title:t,value:s,description:i,icon:o,trend:r,className:c}=e;return(0,l.jsxs)(a.Zb,{className:c,children:[(0,l.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(a.ll,{className:"text-sm font-medium text-muted-foreground",children:t}),(0,l.jsx)(o,{className:"h-4 w-4 text-muted-foreground"})]}),(0,l.jsxs)(a.aY,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:s}),i&&(0,l.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:i}),r&&(0,l.jsxs)("p",{className:(0,n.cn)("text-xs mt-1",r.isPositive?"text-green-500":"text-red-500"),children:[r.isPositive?"+":"-",Math.abs(r.value),"% from last hour"]})]})]})}var c=s(47625),d=s(58336),u=s(56940),m=s(97059),x=s(62994),v=s(8147),h=s(54061);function j(e){let{title:t,data:s,color:i="hsl(var(--primary))",unit:o=""}=e;return(0,l.jsxs)(a.Zb,{children:[(0,l.jsx)(a.Ol,{children:(0,l.jsx)(a.ll,{className:"text-sm font-medium",children:t})}),(0,l.jsx)(a.aY,{children:(0,l.jsx)("div",{className:"h-[200px]",children:(0,l.jsx)(c.h,{width:"100%",height:"100%",children:(0,l.jsxs)(d.w,{data:s,children:[(0,l.jsx)(u.q,{strokeDasharray:"3 3",className:"stroke-muted",vertical:!1}),(0,l.jsx)(m.K,{dataKey:"time",tick:{fontSize:12},tickLine:!1,axisLine:!1,className:"text-muted-foreground"}),(0,l.jsx)(x.B,{tick:{fontSize:12},tickLine:!1,axisLine:!1,className:"text-muted-foreground",tickFormatter:e=>"".concat(e).concat(o)}),(0,l.jsx)(v.u,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"var(--radius)"},labelStyle:{color:"hsl(var(--foreground))"},itemStyle:{color:"hsl(var(--foreground))"}}),(0,l.jsx)(h.x,{type:"monotone",dataKey:"value",stroke:i,strokeWidth:2,dot:!1})]})})})})]})}var p=s(71837),f=s(28124),g=s(83774),y=s(84428),N=s(96137),b=s(50091),_=s(13420),k=s(91723);function S(){var e,t,s,a,n,c,d,u,m,x;let[v,h]=(0,i.useState)(null),[S,M]=(0,i.useState)([]),[Z,w]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=async()=>{try{let e=await (0,p.P0)("SERVER");if(e.ok&&e.stats){h(e.stats);let t=new Date,s="".concat(t.getHours(),":").concat(t.getMinutes().toString().padStart(2,"0"));M(t=>[...t,{time:s,value:e.stats.heap_size/1048576}].slice(-20))}}catch(e){console.error("Failed to fetch stats:",e)}finally{w(!1)}};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[]);let z=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(2))," ").concat(["B","KB","MB","GB"][t])};return Z?(0,l.jsx)(o.c,{children:(0,l.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,l.jsx)("div",{className:"animate-pulse text-muted-foreground",children:"Loading metrics..."})})}):(0,l.jsx)(o.c,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"Dashboard"}),(0,l.jsxs)("p",{className:"text-muted-foreground",children:["Real-time server metrics and statistics",(null==v?void 0:v.version)&&(0,l.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-primary/10 rounded text-xs",children:["v",v.version]})]})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[(0,l.jsx)(r,{title:"Collections",value:null!==(e=null==v?void 0:v.num_collections)&&void 0!==e?e:0,description:"Total geospatial collections",icon:f.Z}),(0,l.jsx)(r,{title:"Objects",value:null!==(t=null==v?void 0:v.num_objects)&&void 0!==t?t:0,description:"Total stored objects",icon:g.Z}),(0,l.jsx)(r,{title:"Memory Usage",value:z(null!==(s=null==v?void 0:v.heap_size)&&void 0!==s?s:0),description:"Current heap size",icon:y.Z}),(0,l.jsx)(r,{title:"System Memory",value:z(null!==(a=null==v?void 0:v.sys_mem_available)&&void 0!==a?a:0),description:(null==v?void 0:v.sys_mem_total)?"".concat(z(v.sys_mem_total)," total"):"Available RAM",icon:N.Z}),(0,l.jsx)(r,{title:"Points",value:null!==(n=null==v?void 0:v.num_points)&&void 0!==n?n:0,description:"Total geospatial points",icon:b.Z})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsx)(j,{title:"Memory Usage (MB)",data:S,color:"hsl(var(--primary))",unit:"MB"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(r,{title:"AOF Size",value:z(null!==(c=null==v?void 0:v.aof_size)&&void 0!==c?c:0),description:"Append-only file size",icon:b.Z}),(0,l.jsx)(r,{title:"In-Memory Size",value:z(null!==(d=null==v?void 0:v.in_memory_size)&&void 0!==d?d:0),description:"Total in-memory data",icon:y.Z})]})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,l.jsx)(r,{title:"Hooks",value:null!==(u=null==v?void 0:v.num_hooks)&&void 0!==u?u:0,description:"Active webhooks/geofences",icon:_.Z}),(0,l.jsx)(r,{title:"Strings",value:null!==(m=null==v?void 0:v.num_strings)&&void 0!==m?m:0,description:"Stored string values",icon:b.Z}),(0,l.jsx)(r,{title:"CPUs",value:null!==(x=null==v?void 0:v.cpus)&&void 0!==x?x:0,description:"Available CPU cores",icon:k.Z})]})]})})}}},function(e){e.O(0,[560,706,176,922,971,117,744],function(){return e(e.s=54806)}),_N_E=e.O()}]);