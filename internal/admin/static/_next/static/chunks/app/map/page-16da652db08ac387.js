(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{59813:function(e,t,i){Promise.resolve().then(i.bind(i,82213))},28124:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});let s=(0,i(79205).Z)("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]])},82431:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});let s=(0,i(79205).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},82213:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return F}});var s=i(57437),n=i(2265),r=i(17054),l=i(39499),o=i(95931),a=i(96480),d=i(68906),h=i(9043),c=i(89202),u=i(69984),f=i(30194),m=i(21595),g=i(8367),p=i(70713),x=i(12646),P=i(78826),y=i(42086),v=i(47545),N=i(60646),w=i(85073),E=i(79669),b=i(86810),O=i(96173),j=i(54894);let C={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class I extends N.Z{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=void 0===e.insertFirst||e.insertFirst,this.stopEvent=void 0===e.stopEvent||e.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==e.className?e.className:"ol-overlay-container "+E.$A,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=!0===e.autoPan?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(C.ELEMENT,this.handleElementChanged),this.addChangeListener(C.MAP,this.handleMapChanged),this.addChangeListener(C.OFFSET,this.handleOffsetChanged),this.addChangeListener(C.POSITION,this.handlePositionChanged),this.addChangeListener(C.POSITIONING,this.handlePositioningChanged),void 0!==e.element&&this.setElement(e.element),this.setOffset(void 0!==e.offset?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),void 0!==e.position&&this.setPosition(e.position)}getElement(){return this.get(C.ELEMENT)}getId(){return this.id}getMap(){return this.get(C.MAP)||null}getOffset(){return this.get(C.OFFSET)}getPosition(){return this.get(C.POSITION)}getPositioning(){return this.get(C.POSITIONING)}handleElementChanged(){(0,j.ep)(this.element);let e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&((0,j.ZF)(this.element),(0,O.bN)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);let e=this.getMap();if(e){this.mapPostrenderListenerKey=(0,O.oL)(e,w.Z.POSTRENDER,this.render,this),this.updatePixelPosition();let t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(C.ELEMENT,e)}setMap(e){this.set(C.MAP,e)}setOffset(e){this.set(C.OFFSET,e)}setPosition(e){this.set(C.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){let t=this.getMap();if(!t||!t.getTargetElement()||!this.get(C.POSITION))return;let i=this.getRect(t.getTargetElement(),t.getSize()),s=this.getElement(),n=this.getRect(s,[(0,j.iO)(s),(0,j.Pb)(s)]),r=void 0===(e=e||{}).margin?20:e.margin;if(!(0,b.r4)(i,n)){let s=n[0]-i[0],l=i[2]-n[2],o=n[1]-i[1],a=i[3]-n[3],d=[0,0];if(s<0?d[0]=s-r:l<0&&(d[0]=Math.abs(l)+r),o<0?d[1]=o-r:a<0&&(d[1]=Math.abs(a)+r),0!==d[0]||0!==d[1]){let i=t.getView().getCenterInternal(),s=t.getPixelFromCoordinateInternal(i);if(!s)return;let n=[s[0]+d[0],s[1]+d[1]],r=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(n),duration:r.duration,easing:r.easing})}}}getRect(e,t){let i=e.getBoundingClientRect(),s=i.left+window.pageXOffset,n=i.top+window.pageYOffset;return[s,n,s+t[0],n+t[1]]}setPositioning(e){this.set(C.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){let e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}let i=e.getPixelFromCoordinate(t),s=e.getSize();this.updateRenderedPosition(i,s)}updateRenderedPosition(e,t){let i=this.element.style,s=this.getOffset(),n=this.getPositioning();this.setVisible(!0);let r=Math.round(e[0]+s[0])+"px",l=Math.round(e[1]+s[1])+"px",o="0%",a="0%";"bottom-right"==n||"center-right"==n||"top-right"==n?o="-100%":("bottom-center"==n||"center-center"==n||"top-center"==n)&&(o="-50%"),"bottom-left"==n||"bottom-center"==n||"bottom-right"==n?a="-100%":("center-left"==n||"center-center"==n||"center-right"==n)&&(a="-50%");let d=`translate(${o}, ${a}) translate(${r}, ${l})`;this.rendered.transform_!=d&&(this.rendered.transform_=d,i.transform=d)}getOptions(){return this.options}}function k(e){let{objects:t=[],center:i=[0,20],zoom:r=2,onSelect:N}=e,w=(0,n.useRef)(null),E=(0,n.useRef)(null),[b,O]=(0,n.useState)(null),[j,C]=(0,n.useState)(null);return(0,n.useEffect)(()=>{if(!w.current)return;let e=new h.Z,t=new d.Z({source:e,style:new f.ZP({fill:new m.Z({color:"rgba(59, 130, 246, 0.2)"}),stroke:new g.Z({color:"#3b82f6",width:2}),image:new p.Z({radius:7,fill:new m.Z({color:"#3b82f6"}),stroke:new g.Z({color:"#ffffff",width:2})})})}),s=new l.Z({target:w.current,layers:[new a.Z({source:new c.Z}),t],view:new o.ZP({center:(0,u.mi)(i),zoom:r})});if(E.current){let e=new I({element:E.current,autoPan:!0});s.addOverlay(e),s.on("click",t=>{let i=s.forEachFeatureAtPixel(t.pixel,e=>e);if(i){let s=i.get("id");C(s),e.setPosition(t.coordinate),N&&N(s)}else C(null),e.setPosition(void 0)})}return O(s),()=>{s.setTarget(void 0)}},[]),(0,n.useEffect)(()=>{if(!b)return;let e=b.getLayers().getArray()[1].getSource();if(e&&(e.clear(),t.forEach(t=>{let i;let s=t.coordinates;if("Point"===t.type&&Array.isArray(s)&&2===s.length?i=new P.Z((0,u.mi)(s)):"LineString"===t.type?i=new y.Z(s.map(e=>(0,u.mi)(e))):"Polygon"===t.type&&(i=new v.ZP([s[0].map(e=>(0,u.mi)(e))])),i){let s=new x.Z({geometry:i,id:t.id});s.set("id",t.id),e.addFeature(s)}}),t.length>0)){let t=e.getExtent();b.getView().fit(t,{padding:[50,50,50,50],maxZoom:15})}},[b,t]),(0,s.jsxs)("div",{className:"relative w-full h-full",children:[(0,s.jsx)("div",{ref:w,className:"w-full h-full rounded-lg overflow-hidden"}),(0,s.jsx)("div",{ref:E,className:"ol-popup bg-card border rounded-lg shadow-lg p-3 min-w-[150px]",style:{display:j?"block":"none"},children:j&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:j}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Click to view details"})]})})]})}i(86037);var S=i(79820),Z=i(12381),L=i(71837),M=i(82431),T=i(28124);function F(){let[e,t]=(0,n.useState)([]),[i,l]=(0,n.useState)(null),[o,a]=(0,n.useState)([]),[d,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{c()},[]),(0,n.useEffect)(()=>{i&&u(i)},[i]);let c=async()=>{try{let e=await (0,L.P0)("KEYS *");e.ok&&e.keys&&(t(e.keys.map(e=>({key:e,count:0}))),e.keys.length>0&&l(e.keys[0]))}catch(e){console.error("Failed to fetch collections:",e)}finally{h(!1)}},u=async e=>{try{let t=await (0,L.P0)("SCAN ".concat(e," LIMIT 1000"));if(t.ok&&t.objects){let e=t.objects.filter(e=>{var t;return null===(t=e.object)||void 0===t?void 0:t.type}).map(e=>({id:e.id,type:e.object.type,coordinates:e.object.coordinates}));a(e)}}catch(e){console.error("Failed to fetch objects:",e)}};return(0,s.jsx)(r.c,{children:(0,s.jsxs)("div",{className:"h-full flex flex-col space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Map View"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Visualize geospatial data on an interactive map"})]}),(0,s.jsxs)(Z.z,{variant:"outline",size:"sm",onClick:()=>c(),children:[(0,s.jsx)(M.Z,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),(0,s.jsxs)("div",{className:"flex-1 flex gap-4 min-h-0",children:[(0,s.jsxs)(S.Zb,{className:"w-64 flex-shrink-0",children:[(0,s.jsx)(S.Ol,{className:"py-3",children:(0,s.jsxs)(S.ll,{className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(T.Z,{className:"w-4 h-4"}),"Collections"]})}),(0,s.jsx)(S.aY,{className:"p-2",children:d?(0,s.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"Loading..."}):0===e.length?(0,s.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No collections found"}):(0,s.jsx)("div",{className:"space-y-1",children:e.map(e=>(0,s.jsx)("button",{onClick:()=>l(e.key),className:"w-full text-left px-3 py-2 rounded-md text-sm transition-colors ".concat(i===e.key?"bg-primary text-primary-foreground":"hover:bg-accent"),children:e.key},e.key))})})]}),(0,s.jsx)(S.Zb,{className:"flex-1",children:(0,s.jsx)(S.aY,{className:"p-0 h-full",children:(0,s.jsx)(k,{objects:o,onSelect:e=>{console.log("Selected object:",e)}})})})]})]})})}}},function(e){e.O(0,[226,560,706,437,922,971,117,744],function(){return e(e.s=59813)}),_N_E=e.O()}]);